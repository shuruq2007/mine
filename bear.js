// Wisdom Bear - Complete Life Advice AI

// Wisdom Database - OVER 100 POSITIVE MESSAGES!
const wisdomDatabase = {
    lifeAdvice: [
        "Life is a journey, not a destination. Enjoy each moment! üåü",
        "The best view comes after the hardest climb. Keep going! üèîÔ∏è",
        "Your only limit is your mind. Dream bigger! üå†",
        "Every day is a new beginning. Take a deep breath and start fresh! üåÖ",
        "The flower that blooms in adversity is the most rare and beautiful of all. üå∏",
        "Life is 10% what happens to you and 90% how you react to it. ‚ö°",
        "Don't watch the clock; do what it does. Keep going! ‚è∞",
        "The secret of getting ahead is getting started. üöÄ",
        "You are never too old to set another goal or to dream a new dream. ‚ú®",
        "Believe you can and you're halfway there. üí™",
        "The only way to do great work is to love what you do. ‚ù§Ô∏è",
        "Success is not final, failure is not fatal: it is the courage to continue that counts. üèÜ",
        "Your time is limited, don't waste it living someone else's life. ‚è≥",
        "The future belongs to those who believe in the beauty of their dreams. üåà",
        "It's not whether you get knocked down, it's whether you get up. üëä"
    ],
    
    positiveThoughts: [
        "Today is a beautiful day to be alive! üåû",
        "You are enough, you have enough, you do enough. üôè",
        "Every morning is a fresh start. What a blessing! üåÑ",
        "You are braver than you believe, stronger than you seem, and smarter than you think. üêª",
        "Happiness is not by chance, but by choice. Choose it today! üòä",
        "The sun will rise and we will try again. ‚òÄÔ∏è",
        "You're doing amazing, sweetie! üå∏",
        "Good things are coming your way. Stay positive! ‚ú®",
        "Your vibe attracts your tribe. Spread positivity! ‚ö°",
        "Today's possibilities are endless. What will you create? üé®",
        "You are a magnet for miracles. Expect good things! üß≤",
        "The universe is working in your favor. Trust the process. üåå",
        "You are worthy of all the good things life has to offer. üí´",
        "Today, choose peace over perfection. üïäÔ∏è",
        "Your presence is a present to the world. üéÅ"
    ],
    
    motivation: [
        "Don't stop when you're tired. Stop when you're done! üí•",
        "Push yourself because no one else is going to do it for you! üèÉ‚Äç‚ôÇÔ∏è",
        "The harder you work for something, the greater you'll feel when you achieve it. üèÜ",
        "Dream it. Wish it. Do it. üå†",
        "Success doesn't just find you. You have to go out and get it! üîç",
        "The key to success is to focus on goals, not obstacles. üóùÔ∏è",
        "Don't limit your challenges. Challenge your limits. ‚ö°",
        "Wake up with determination. Go to bed with satisfaction. üò¥",
        "Great things never come from comfort zones. üöÄ",
        "Your only competition is the person you were yesterday. ü•á",
        "Small steps every day lead to big results over time. üë£",
        "The pain of discipline is less than the pain of regret. üí™",
        "Make today so awesome that yesterday gets jealous. üòé",
        "Your potential is endless. Go get what you deserve. üåü",
        "The moment you're ready to quit is usually the moment right before a miracle happens. ‚ú®"
    ],
    
    happinessTips: [
        "Smile more. It increases your face value! üòÑ",
        "Gratitude turns what we have into enough. üôè",
        "Surround yourself with people who lift you higher. üë•",
        "Dance like nobody's watching! üíÉ",
        "Listen to music that makes you happy. üéµ",
        "Spend time in nature. It's free therapy! üå≥",
        "Help someone without expecting anything in return. ü§ù",
        "Keep a gratitude journal. Write 3 things you're thankful for daily. üìñ",
        "Laugh out loud every day. It's medicine for the soul! üòÇ",
        "Do more of what makes you forget to check your phone. üì±",
        "Celebrate small wins. Every step counts! üéâ",
        "Take a deep breath. You're doing just fine. üå¨Ô∏è",
        "Be present. This moment will never come again. ‚è≥",
        "Forgive others, not because they deserve it, but because you deserve peace. üïäÔ∏è",
        "Love yourself first. Everything else falls into place. ‚ù§Ô∏è"
    ],
    
    stressRelief: [
        "Breathe in calm, breathe out stress. You've got this! üå¨Ô∏è",
        "This too shall pass. Everything is temporary. üåä",
        "You cannot control everything. Let go and let flow. üçÉ",
        "Take it one day at a time. One step at a time. üë£",
        "Your mental health is more important than your productivity. üß†",
        "It's okay to not be okay. Rest if you must. üõå",
        "Nature has a way of healing. Go for a walk. üö∂‚Äç‚ôÄÔ∏è",
        "Write it down. Get it out of your head and onto paper. üìù",
        "Talk to someone. You don't have to carry it all alone. üí¨",
        "Meditate for 5 minutes. Find your center. üßò‚Äç‚ôÄÔ∏è",
        "Listen to calming music or nature sounds. üé∂",
        "Drink some herbal tea. Chamomile works wonders! ‚òï",
        "Stretch your body. Release the tension. üßò‚Äç‚ôÇÔ∏è",
        "Remember: You've survived 100% of your worst days. üèÜ",
        "Tomorrow is a new day with new possibilities. üåÖ"
    ],
    
    successTips: [
        "Consistency beats talent every single time. üìÖ",
        "Learn from yesterday, live for today, hope for tomorrow. üéì",
        "Your network is your net worth. Build genuine connections. ü§ù",
        "Read every day. Knowledge is power. üìö",
        "Fail forward. Every failure is a lesson. üìà",
        "Say 'no' to things that don't align with your goals. üö´",
        "Wake up early. The morning has gold in its mouth. üåÖ",
        "Invest in yourself. It pays the best interest. üí∞",
        "Listen more than you speak. You have two ears and one mouth for a reason. üëÇ",
        "Take calculated risks. Fortune favors the bold. üé≤",
        "Build habits, not goals. Success is a daily practice. üîÑ",
        "Find a mentor. Learn from those who've walked the path. üß≠",
        "Stay curious. Ask questions. Never stop learning. ‚ùì",
        "Take care of your health. Energy is everything. üèãÔ∏è‚Äç‚ôÄÔ∏è",
        "Visualize your success. See it, believe it, achieve it. üéØ"
    ],
    
    loveAndRelationships: [
        "Love yourself first. You can't pour from an empty cup. ‚ù§Ô∏è",
        "The right people will love you at your worst. üë•",
        "Communication is the foundation of every strong relationship. üí¨",
        "Quality time > quantity of gifts. ‚è∞",
        "Forgive, but don't forget the lesson. üß†",
        "Your peace is more important than drama. Choose peace. üïäÔ∏è",
        "Set boundaries. It's an act of self-love. üöß",
        "Apologize when you're wrong. Pride costs too much. üôè",
        "Listen to understand, not to reply. üëÇ",
        "Celebrate each other's successes. üéâ",
        "Grow together, not apart. üå±",
        "Laugh together every day. üòÇ",
        "Small gestures matter more than grand ones. üíù",
        "Trust takes years to build, seconds to break. üîí",
        "Choose someone who chooses you back. üíë"
    ]
};

// Bear State
let bearState = {
    happiness: 85,
    isTalking: false,
    wisdomShared: 0,
    currentMood: 'happy'
};

// DOM Elements
const chatMessages = document.getElementById('chatMessages');
const messageInput = document.getElementById('messageInput');
const sendButton = document.getElementById('sendMessage');
const happinessLevel = document.getElementById('happinessLevel');
const happinessIndicator = document.getElementById('happinessIndicator');
const bearMouth = document.getElementById('bearMouth');
const leftPupil = document.getElementById('leftPupil');
const rightPupil = document.getElementById('rightPupil');
const voiceToggle = document.getElementById('voiceToggle');
const voiceStatus = document.getElementById('voiceStatus');
const wisdomModal = document.getElementById('wisdomModal');
const modalWisdom = document.getElementById('modalWisdom');

// Speech Synthesis
const synth = window.speechSynthesis;
let isSpeaking = false;

// Initialize Bear
function initBear() {
    // Setup event listeners
    sendButton.addEventListener('click', sendMessage);
    messageInput.addEventListener('keypress', (e) => {
        if (e.key === 'Enter') sendMessage();
    });
    
    // Voice toggle
    voiceToggle.addEventListener('click', toggleVoice);
    
    // Bear actions
    document.getElementById('petBear').addEventListener('click', petBear);
    document.getElementById('hugBear').addEventListener('click', hugBear);
    document.getElementById('danceBear').addEventListener('click', danceBear);
    document.getElementById('wisdomBear').addEventListener('click', showWisdomModal);
    
    // Wisdom buttons
    document.querySelectorAll('.wisdom-btn').forEach(btn => {
        btn.addEventListener('click', (e) => {
            const type = e.currentTarget.dataset.type;
            giveWisdom(type);
        });
    });
    
    // Category cards
    document.querySelectorAll('.category-card').forEach(card => {
        card.addEventListener('click', (e) => {
            const category = e.currentTarget.dataset.category;
            giveWisdom(category);
        });
    });
    
    // Modal buttons
    document.querySelector('.close-modal').addEventListener('click', () => {
        wisdomModal.classList.remove('active');
    });
    
    document.getElementById('nextWisdom').addEventListener('click', nextWisdom);
    document.getElementById('speakWisdom').addEventListener('click', speakCurrentWisdom);
    document.getElementById('copyWisdom').addEventListener('click', copyWisdom);
    
    // Footer buttons
    document.getElementById('newWisdom').addEventListener('click', getRandomWisdom);
    document.getElementById('shareWisdom').addEventListener('click', shareWisdom);
    document.getElementById('saveWisdom').addEventListener('click', saveWisdom);
    
    // Update daily wisdom
    updateDailyWisdom();
    
    // Start eye movement
    startEyeMovement();
    
    // Initial welcome
    setTimeout(() => {
        addMessage("Welcome to Wisdom Bear! üêª‚ú® I'm here to share positivity, life advice, and help you grow!", 'bear');
        speak("Welcome to Wisdom Bear! I'm here to share positivity and life advice with you!");
    }, 1000);
    
    // Update happiness display
    updateHappinessDisplay();
}

// Send message
function sendMessage() {
    const text = messageInput.value.trim();
    if (!text) return;
    
    addMessage(text, 'user');
    messageInput.value = '';
    
    setTimeout(() => processMessage(text), 500);
}

// Process user message
function processMessage(text) {
    const lowerText = text.toLowerCase();
    
    // Show bear is thinking
    showThinking(true);
    
    setTimeout(() => {
        showThinking(false);
        
        let response = '';
        
        // Life advice requests
        if (containsAny(lowerText, ['life advice', 'advice for life', 'guidance', 'what should i do'])) {
            response = getRandomWisdom('lifeAdvice');
        }
        // Positive messages
        else if (containsAny(lowerText, ['positive', 'happy', 'cheer me up', 'motivate', 'inspire'])) {
            response = getRandomWisdom('positiveThoughts');
        }
        // Motivation
        else if (containsAny(lowerText, ['motivation', 'push me', 'encourage', 'keep going'])) {
            response = getRandomWisdom('motivation');
        }
        // Happiness
        else if (containsAny(lowerText, ['happiness', 'happy tips', 'be happy', 'joy'])) {
            response = getRandomWisdom('happinessTips');
        }
        // Stress
        else if (containsAny(lowerText, ['stress', 'anxious', 'worried', 'calm', 'relax'])) {
            response = getRandomWisdom('stressRelief');
        }
        // Success
        else if (containsAny(lowerText, ['success', 'achieve', 'goal', 'win', 'succeed'])) {
            response = getRandomWisdom('successTips');
        }
        // Love
        else if (containsAny(lowerText, ['love', 'relationship', 'friend', 'family', 'partner'])) {
            response = getRandomWisdom('loveAndRelationships');
        }
        // Greetings
        else if (containsAny(lowerText, ['hello', 'hi', 'hey', 'greetings'])) {
            response = "Hello friend! üêª Ready for some wisdom today? Ask me for life advice or positive thoughts!";
        }
        // How are you
        else if (containsAny(lowerText, ['how are you', 'how you doing'])) {
            response = `I'm feeling ${bearState.currentMood}! My happiness level is ${bearState.happiness}%! Ready to share wisdom with you!`;
        }
        // Thank you
        else if (containsAny(lowerText, ['thank', 'thanks', 'appreciate'])) {
            response = "You're very welcome! ü•∞ Remember, kindness is free - sprinkle that stuff everywhere!";
            increaseHappiness(10);
        }
        // Love you
        else if (containsAny(lowerText, ['love you', 'like you', 'care about you'])) {
            response = "Aww, I love you too! üêªüíñ You're an amazing person!";
            increaseHappiness(20);
        }
        // Default response
        else {
            response = getRandomResponse([
                "That's an interesting thought! Here's some wisdom for you: " + getRandomWisdom('lifeAdvice'),
                "I love our conversations! Let me share something positive: " + getRandomWisdom('positiveThoughts'),
                "Thanks for sharing! Remember: " + getRandomWisdom('motivation'),
                getRandomWisdom('positiveThoughts')
            ]);
        }
        
        // Add response
        addMessage(response, 'bear');
        
        // Speak response
        speak(response);
        
        // Increase wisdom count
        bearState.wisdomShared++;
        document.getElementById('wisdomCount').textContent = bearState.wisdomShared;
        
        // Animate bear
        animateBearTalking();
        
    }, 1000 + Math.random() * 1000);
}

// Get random wisdom
function getRandomWisdom(category = null) {
    if (!category) {
        // Get random category
        const categories = Object.keys(wisdomDatabase);
        category = categories[Math.floor(Math.random() * categories.length)];
    }
    
    const wisdomList = wisdomDatabase[category] || wisdomDatabase.lifeAdvice;
    return wisdomList[Math.floor(Math.random() * wisdomList.length)];
}

// Add message to chat
function addMessage(text, sender) {
    const messageDiv = document.createElement('div');
    messageDiv.className = `message ${sender}-message`;
    
    const time = new Date().toLocaleTimeString([], { hour: '2-digit', minute: '2-digit' });
    
    messageDiv.innerHTML = `
        <div class="message-avatar">
            <i class="fas fa-${sender === 'user' ? 'user' : 'bear'}"></i>
        </div>
        <div class="message-content">
            <div class="message-header">
                <strong>${sender === 'user' ? 'You' : 'Wisdom Bear'}</strong>
                <span class="message-time">${time}</span>
            </div>
            <p>${escapeHtml(text)}</p>
        </div>
    `;
    
    chatMessages.appendChild(messageDiv);
    chatMessages.scrollTop = chatMessages.scrollHeight;
}

// Speak text
function speak(text) {
    if (!synth || isSpeaking) return;
    
    synth.cancel();
    
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.rate = 0.9;
    utterance.pitch = 0.8;
    utterance.volume = 1;
    
    isSpeaking = true;
    
    utterance.onstart = () => {
        animateBearTalking();
    };
    
    utterance.onend = () => {
        isSpeaking = false;
        stopTalking();
    };
    
    synth.speak(utterance);
}

// Animate bear talking
function animateBearTalking() {
    bearMouth.parentElement.classList.add('talking');
}

function stopTalking() {
    bearMouth.parentElement.classList.remove('talking');
}

// Show thinking indicator
function showThinking(show) {
    const indicator = document.querySelector('.thinking-indicator');
    if (!indicator) {
        const indicator = document.createElement('div');
        indicator.className = 'thinking-indicator';
        indicator.innerHTML = '<i class="fas fa-brain"></i> Bear is thinking...';
        document.querySelector('.chat-input-area').prepend(indicator);
    }
    
    if (show) {
        indicator.style.display = 'block';
    } else {
        indicator.style.display = 'none';
    }
}

// Bear interactions
function petBear() {
    addMessage("You gently pet Wisdom Bear. He smiles warmly! üêªüíï", 'system');
    speak("That feels nice! Thank you for the pets!");
    increaseHappiness(15);
    animateBearTalking();
    
    // Add random wisdom
    setTimeout(() => {
        addMessage("Here's a little wisdom for your kindness: " + getRandomWisdom(), 'bear');
    }, 1500);
}

function hugBear() {
    addMessage("You give Wisdom Bear a big warm hug! He hugs you back tightly! ü§óüíñ", 'system');
    speak("Aww, thank you for the hug! You're wonderful!");
    increaseHappiness(25);
    animateBearTalking();
}

function danceBear() {
    addMessage("Wisdom Bear starts dancing happily! üï∫üíÉ He's got some smooth moves!", 'system');
    speak("Let's dance! Woohoo! Life is a celebration!");
    increaseHappiness(20);
    animateBearTalking();
}

// Give wisdom based on type
function giveWisdom(type) {
    const wisdom = getRandomWisdom(type);
    addMessage(wisdom, 'bear');
    speak(wisdom);
    animateBearTalking();
    increaseHappiness(5);
    
    bearState.wisdomShared++;
    document.getElementById('wisdomCount').textContent = bearState.wisdomShared;
}

// Show wisdom modal
function showWisdomModal() {
    modalWisdom.textContent = getRandomWisdom();
    wisdomModal.classList.add('active');
}

function nextWisdom() {
    modalWisdom.textContent = getRandomWisdom();
}

function speakCurrentWisdom() {
    speak(modalWisdom.textContent);
}

function copyWisdom() {
    navigator.clipboard.writeText(modalWisdom.textContent)
        .then(() => {
            alert('Wisdom copied to clipboard! üìã');
        })
        .catch(err => {
            console.error('Failed to copy: ', err);
        });
}

// Update daily wisdom
function updateDailyWisdom() {
    const dailyWisdom = document.getElementById('dailyWisdom');
    if (dailyWisdom) {
        const wisdomText = dailyWisdom.querySelector('.wisdom-text');
        wisdomText.textContent = getRandomWisdom();
    }
}

function getRandomWisdom() {
    const categories = Object.keys(wisdomDatabase);
    const randomCategory = categories[Math.floor(Math.random() * categories.length)];
    const wisdomList = wisdomDatabase[randomCategory];
    return wisdomList[Math.floor(Math.random() * wisdomList.length)];
}

function shareWisdom() {
    const wisdom = getRandomWisdom();
    if (navigator.share) {
        navigator.share({
            title: 'Wisdom from Bear üêª',
            text: wisdom,
            url: window.location.href
        });
    } else {
        navigator.clipboard.writeText(wisdom);
        alert('Wisdom copied! Share it with someone who needs it! üìã');
    }
}

function saveWisdom() {
    const wisdom = getRandomWisdom();
    localStorage.setItem('savedWisdom', wisdom);
    alert('Wisdom saved! You can find it in your browser storage. üíæ');
}

// Increase happiness
function increaseHappiness(amount) {
    bearState.happiness = Math.min(100, Math.max(0, bearState.happiness + amount));
    
    // Update mood
    if (bearState.happiness >= 80) bearState.currentMood = 'extremely happy';
    else if (bearState.happiness >= 60) bearState.currentMood = 'happy';
    else if (bearState.happiness >= 40) bearState.currentMood = 'content';
    else if (bearState.happiness >= 20) bearState.currentMood = 'okay';
    else bearState.currentMood = 'sad';
    
    updateHappinessDisplay();
}

// Update happiness display
function updateHappinessDisplay() {
    happinessLevel.textContent = `${bearState.happiness}%`;
    
    // Update happiness indicator emoji
    let emoji = 'üòä';
    if (bearState.happiness >= 90) emoji = 'üòÑ';
    else if (bearState.happiness >= 70) emoji = 'üòä';
    else if (bearState.happiness >= 50) emoji = 'üôÇ';
    else if (bearState.happiness >= 30) emoji = 'üòê';
    else emoji = 'üòî';
    
    happinessIndicator.textContent = emoji;
}

// Eye movement
function startEyeMovement() {
    setInterval(() => {
        const x = Math.random() * 10 - 5;
        const y = Math.random() * 10 - 5;
        
        leftPupil.style.transform = `translate(${x}px, ${y}px)`;
        rightPupil.style.transform = `translate(${x}px, ${y}px)`;
    }, 3000);
}

// Voice toggle
function toggleVoice() {
    if (!('webkitSpeechRecognition' in window || 'SpeechRecognition' in window)) {
        alert("Voice recognition works best in Chrome or Edge. Please use text input.");
        return;
    }
    
    voiceToggle.classList.toggle('active');
    
    if (voiceToggle.classList.contains('active')) {
        startVoiceRecognition();
    } else {
        stopVoiceRecognition();
    }
}

// Voice recognition
let recognition = null;

function startVoiceRecognition() {
    const SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    recognition = new SpeechRecognition();
    
    recognition.continuous = false;
    recognition.interimResults = false;
    recognition.lang = 'en-US';
    
    recognition.onstart = () => {
        voiceStatus.textContent = "Listening... Speak now!";
        voiceToggle.innerHTML = '<i class="fas fa-microphone-slash"></i> Stop';
    };
    
    recognition.onresult = (event) => {
        const transcript = event.results[0][0].transcript;
        messageInput.value = transcript;
        sendMessage();
    };
    
    recognition.onerror = (event) => {
        console.error('Speech recognition error', event.error);
        voiceStatus.textContent = "Error listening. Try again!";
        stopVoiceRecognition();
    };
    
    recognition.onend = () => {
        stopVoiceRecognition();
    };
    
    recognition.start();
}

function stopVoiceRecognition() {
    if (recognition) {
        recognition.stop();
    }
    
    voiceToggle.classList.remove('active');
    voiceToggle.innerHTML = '<i class="fas fa-microphone"></i> Voice Input';
    voiceStatus.textContent = "Click microphone to speak";
}

// Helper functions
function containsAny(text, keywords) {
    return keywords.some(keyword => text.includes(keyword));
}

function getRandomResponse(responses) {
    return responses[Math.floor(Math.random() * responses.length)];
}

function escapeHtml(text) {
    const div = document.createElement('div');
    div.textContent = text;
    return div.innerHTML;
}

// Initialize when page loads
window.addEventListener('load', initBear);

// Make available globally
window.WisdomBear = {
    speak: speak,
    getWisdom: getRandomWisdom,
    increaseHappiness: increaseHappiness
};
